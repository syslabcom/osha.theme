<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone">

<metal:block tal:define="dummy python:request.RESPONSE.setHeader('Cache-control', 'max-age=0,s-maxage=3600')" />

  <body>
    <div metal:fill-slot="main">

    <h1  class="documentFirstHeading" tal:content="context/Title">Title</h1>

  <div class="photoAlbum">
    <div class="photoAlbumEntry photoAlbumFolder">

        <span class="photoAlbumEntryWrapperWrapper" 
          tal:condition="view/has_section_image">
          <span class="photoAlbumEntryWrapper">
            <img width="128" title="Section Title" 
                alt="Section Alt" src="../section-image.png"
                tal:attributes="alt view/getSectionTitle;
                                title view/getSectionTitle" />
          </span>
          <span class="photoAlbumEntryTitle database-emphasis"
              tal:content="view/getSectionTitle">
              Section Title 
          </span>
        </span>
      
    </div>
  </div>

    <metal:field use-macro="python:here.widget('text', mode='view')">
      Body text
    </metal:field>

    <br clear="all">

    <form tal:attributes="action template/id" method="get">

      <div id="filter_searchfields">

        <h1>Search in the 
          <span class="database-emphasis">
            <span tal:content="here/Title">Risk Assessment</span>
            Database
          </span>
        </h1>

        <div class="field_default">
          <input type="text"
                  id="SearchableText"
                  name="SearchableText"
                  size="25"
                  tal:attributes="value request/SearchableText|nothing"
                  />
        </div>

        <div class="formControls">
          <input class="context"
                   type="submit"
                   name="submit"
                   value="Search"
                   i18n:domain="plone"
                   i18n:attributes="value label_search;"
                   />
          <input  class="context" type="reset" value="Reset"
                tal:attributes="onclick string:window.location='${here/absolute_url}/${template/getId}'" />

        </div>
    </form>

    <span tal:define="local_keyword python:here.getProperty('keyword', '');
                      keywords request/keywords| local_keyword |string:;
                      subcategory request/subcategory | string:;
                      object_implements request/object_implements | string:;
                      SearchableText request/SearchableText|string:;
                      multilingual_thesaurus request/multilingual_thesaurus|string:;
                      nace request/nace|string:;
                      nace python:nace==[''] and '' or nace;
                      category request/category|string:;
                      getRemoteLanguage request/getRemoteLanguage|string:;
                      country request/country|string:;
                      search_portal_types view/search_portal_types;
                      Batch python:modules['Products.CMFPlone'].Batch;
                      DateTime python:modules['DateTime'].DateTime;
                      b_size python:10;b_start python:0;
                      b_start request/b_start | b_start;
                      desc_length site_properties/search_results_description_length;
                      desc_ellipsis site_properties/ellipsis;
                      searchterm request/SearchableText|nothing;
                      ">
        <div tal:define="results view/search">

            <!--i>Filtered by:
                <span tal:replace="view/buildQuery"/>
            </i-->

        <h2>
            <span i18n:translate="heading_search_results">
                Search results
            </span>
            <span class="discreet">
            &mdash;
            <span i18n:translate="batch_x_items_matching_your_criteria"
            ><span i18n:name="number"
            tal:omit-tag=""
            tal:content="python:len(results)">234</span> items matching your
                                                         search terms</span>
        </h2>

        <div tal:condition="not: results">
            <p><strong i18n:translate="description_no_results_found">No results were found.</strong></p>
        </div>

        <div tal:condition="results"
            tal:define="batch python:Batch(results, b_size, int(b_start), orphan=1);">

            <dl id="db_results">
            <tal:results repeat="result batch">
            <tal:entry define="provider_helper here/@@provider_helper;
                              result_url result/getURL;
                              url result/getRemoteUrl | result_url;
                              title result/Title|string:;
                              item_cas result/getCas|string:;
                              item_einecs result/getEinecs|string:;
                              item_remoteLanguage result/getRemoteLanguage|string:;
                              item_subject result/Subject | python:[];
                              item_modified result/modified;
                              item_pubdate result/effective;
                              item_creator result/Creator;
                              gc python:here.portal_languages.getNameForLanguageCode;
                              ">

                <metal:macro use-macro="here/oshmacros/macros/searchresults" />

            </tal:entry>
            </tal:results>
            </dl>

            <div class="visualClear" ></div>

            <div metal:use-macro="here/batch_macros/macros/navigation" />

            <!-- Snapshot code -->
            <script type="text/javascript" src="http://shots.snap.com/ss/8c2016f0b237f14c8e18548d26c3d103/snap_shots.js"></script>
        </div>

      </div>

    </span>


    </div> 
  </body>
</html>
